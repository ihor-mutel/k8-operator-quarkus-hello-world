<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>Kubernetes Operator with Java and Quarkus</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Kubernetes Operator with Java and Quarkus</h1>
</div>
<div id="content">
<div class="sect4">
<h5 id="_tldr">TL;DR</h5>
<div class="paragraph">
<p>Even though Kubernetes provides extensive support for multiple container management operations, it doesn&#8217;t cover all potential cases related to application management. Some applications need the manual intervention of the human operator. An operator is an application that runs in the cluster and manages resources.
It allows transferring of operational knowledge of the human operators into software components. Operators can be used for multiple purposes such as restoring data, creating cloud resources, resilience testing, and many others.</p>
</div>
</div>
<div class="sect3">
<h4 id="_why_java">Why java?</h4>
<div class="ulist">
<ul>
<li>
<p>Being able to develop operators in Java can bring a lot of benefits for companies and individuals that are focused mainly on the Java stack.</p>
</li>
<li>
<p>Quarkus with the main focus on cloud-native, and microservice solutions looks like a right fit for building an operator.</p>
</li>
<li>
<p>Operator SDK also has neat features such as generating Kubernetes resources for operator deployment in the cluster and creating custom resource definition yaml files based on the Java code.</p>
</li>
<li>
<p>Java kubernetes-client supports multiple operations: such as creating resources, patching. copying files,  executing commands, fetching logs and
<a href="https://github.com/fabric8io/kubernetes-client/tree/master/kubernetes-examples/src/main/java/io/fabric8/kubernetes/examples">many others</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_hello_world_operator">Hello world operator</h4>
<div class="paragraph">
<p>An Operator can be used for various reasons and one of the most common tasks of the operator is to manage database clusters, and performing operations like preparing database schemas, restoring backups, etc. This simple hello world operator demonstrates how to create a stateful set and make sure that the data is loaded into each pod and consumed by the application before creating new pods.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="media/image-2021-04-18-22-56-52-151.png" alt="image 2021 04 18 22 56 52 151" width="40%">
</div>
</div>
<div class="paragraph">
<p>It performs following operations with Kubernetes API using java  <a href="https://github.com/kubernetes-client/java">kubernetes-client</a> and <a href="https://github.com/quarkiverse/quarkus-operator-sdk">quarkus-operator-sdk</a> :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>watch custom resource creation/modification</p>
</li>
<li>
<p>watch pod creation/modification</p>
</li>
<li>
<p>create and scale statefulsets</p>
</li>
<li>
<p>check content of log output</p>
</li>
<li>
<p>execute commands in a container</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_generate_a_project">Generate a project</h4>
<div class="paragraph">
<p>An official webpage to Generate Quarkus application <a href="https://code.quarkus.io" class="bare">https://code.quarkus.io</a>. The generated project also includes <a href="https://docs.docker.com/engine/reference/builder/">Dockerfile</a> for building <a href="https://docs.docker.com/engine/reference/commandline/images/">Docker images</a>.</p>
</div>
<details>
<summary class="title">Dockerfile</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="Dockerfile">FROM registry.access.redhat.com/ubi8/ubi-minimal:8.3
WORKDIR /work/
RUN chown 1001 /work \
    &amp;&amp; chmod &quot;g+rwX&quot; /work \
    &amp;&amp; chown 1001:root /work
COPY --chown=1001:root target/*-runner /work/application

EXPOSE 8080
USER 1001

CMD [&quot;./application&quot;, &quot;-Dquarkus.http.host=0.0.0.0&quot;]</code></pre>
</div>
</div>
</div>
</details>
<div class="sect4">
<h5 id="_add_dependencies_into_a_project">Add dependencies into a project:</h5>
<div class="paragraph">
<p><a href="https://github.com/quarkiverse/quarkus-operator-sdk">quarkus-operator-sdk</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
<span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>io.quarkiverse.operatorsdk<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
<span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>quarkus-operator-sdk<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
<span style="color:#070;font-weight:bold">&lt;version&gt;</span>1.8.2<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://github.com/kubernetes-client/java">kubernetes-client</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
 <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>io.kubernetes<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
 <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>client-java<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
 <span style="color:#070;font-weight:bold">&lt;version&gt;</span>12.0.0<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Proxy kubernetes cluster API to local machine for the local development</p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl --namespace kube-system --disable-filter=true proxy kube-apiserver-kind-control-plane</pre>
</div>
</div>
<div class="paragraph">
<p>Configure application.properties for the local development environment</p>
</div>
<div class="listingblock">
<div class="content">
<pre>quarkus.kubernetes-client.trust-certs=false
quarkus.kubernetes-client.namespace=default
quarkus.kubernetes-client.master-url=http://127.0.0.1:8001/</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_create_a_custom_resource_definition">Create a custom resource definition</h5>
<div class="paragraph">
<p>It is possible to extend the Kubernetes API with custom resources, in order to store and modify the desired object specification and state.</p>
</div>
<div class="paragraph">
<p>Based on the content of classes below application generates <a href="https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/">custom-resource-definitions</a> which can be used to create <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">custom-resources</a>. During the start application outputs yaml of custom resource definitions to a file in the directory <em>./target/kubernetes/</em>.</p>
</div>
<div class="paragraph">
<p>Create custom resource definition</p>
</div>
<div class="listingblock">
<div class="title">HelloWorld.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Group</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.com</span><span style="color:#710">&quot;</span></span>)
<span style="color:#007">@Version</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">v1alpha1</span><span style="color:#710">&quot;</span></span>)
<span style="color:#007">@ShortNames</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">hw</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">HelloWorld</span> <span style="color:#088;font-weight:bold">extends</span> CustomResource&lt;HelloWorldSpec, HelloWorldStatus&gt; <span style="color:#088;font-weight:bold">implements</span> Namespaced {

   <span style="color:#088;font-weight:bold">private</span> HelloWorldSpec spec;
   <span style="color:#088;font-weight:bold">private</span> HelloWorldStatus status;

   <span style="color:#777">// {...}</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Creating specification fields of the custom resource.</p>
</div>
<div class="listingblock">
<div class="title">HelloWorldSpec.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">HelloWorldSpec</span> {

   <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> name;
   <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> image;
   <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> data;
   <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> replicas;

   <span style="color:#777">// {...}</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The status fields of the custom resource</p>
</div>
<div class="listingblock">
<div class="title">HelloWorldStatus.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">HelloWorldStatus</span> {

   <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Integer</span> readyReplicas = <span style="color:#00D">0</span>;

   <span style="color:#777">// {...}</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Create custom resource of kind HelloWorld</p>
</div>
<div class="listingblock">
<div class="title">hello-world-example.yaml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">example.com/v1alpha1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">HelloWorld</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">hello-world-example</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">hello-world</span></span>
  <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">busybox</span></span>
  <span style="color:#606">replicas</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">3</span></span>
  <span style="color:#606">data</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">|</span><span style="color:#D20">
   Example of injected data</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl create -f hello-world-example.yaml</pre>
</div>
</div>
<div class="paragraph">
<p>A client for kubernetes API</p>
</div>
<div class="listingblock">
<div class="title">KubernetesClientProducer.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Singleton</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">KubernetesClientProducer</span> {

   <span style="color:#007">@Produces</span>
   <span style="color:#088;font-weight:bold">public</span> KubernetesClient kubernetesClient() {
       <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> DefaultKubernetesClient(command in container);
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A controller which listens to custom resource creation and updates</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Controller</span>(namespaces = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">default</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">HelloWorldController</span>  <span style="color:#088;font-weight:bold">implements</span> ResourceController&lt;HelloWorld&gt; {

   / ... /

   <span style="color:#007">@Override</span>
   <span style="color:#088;font-weight:bold">public</span> DeleteControl deleteResource(HelloWorld resource, <span style="color:#0a8;font-weight:bold">Context</span>&lt;HelloWorld&gt; context) {...}

   <span style="color:#007">@Override</span>
   <span style="color:#088;font-weight:bold">public</span> UpdateControl&lt;HelloWorld&gt; createOrUpdateResource(HelloWorld helloWorldRequest, <span style="color:#0a8;font-weight:bold">Context</span>&lt;HelloWorld&gt; context) {...}

   <span style="color:#007">@Override</span>
   <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> init(EventSourceManager eventSourceManager) {...}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the custom resource HelloWorld is created or updated operator receives an event and based on this event it creates a stateful set according to custom object content.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="media/image-2021-04-18-22-37-49-046.png" alt="image 2021 04 18 22 37 49 046" width="50%">
</div>
</div>
<details>
<summary class="title">HelloWorldController.java</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Override</span>
<span style="color:#088;font-weight:bold">public</span> UpdateControl&lt;HelloWorld&gt; createOrUpdateResource(HelloWorld helloWorldRequest, <span style="color:#0a8;font-weight:bold">Context</span>&lt;HelloWorld&gt; context) {
   <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">var</span> spec = helloWorldRequest.getSpec();

   StatefulSet statefulset = kubernetesClient.apps().statefulSets().withName(spec.getName()).get();

   <span style="color:#080;font-weight:bold">if</span>(statefulset == <span style="color:#069">null</span>) {
       log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Create statefulset </span><span style="color:#710">&quot;</span></span> + spec.getName());

       statefulset = <span style="color:#080;font-weight:bold">new</span> StatefulSetBuilder()
               .withNewMetadata()
               .withName(spec.getName())
               .endMetadata()
               .withNewSpec()
               .withReplicas(<span style="color:#00D">1</span>)
               .withNewTemplate()
               .withNewMetadata()
               .addToLabels(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">app</span><span style="color:#710">&quot;</span></span>, spec.getName())
               .endMetadata()
               .withNewSpec()
               .addNewContainer()
               .withName(spec.getName())
               .withImage(spec.getImage())
               .withCommand(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sh</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">-c</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">while sleep 5; do cat /tmp/data.txt; done</span><span style="color:#710">&quot;</span></span>)
               .addNewPort()
               .withContainerPort(<span style="color:#00D">80</span>)
               .endPort()
               .endContainer()
               .endSpec()
               .endTemplate()
               .withNewSelector()
               .addToMatchLabels(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">app</span><span style="color:#710">&quot;</span></span>, spec.getName())
               .endSelector()
               .endSpec()
               .build();

       kubernetesClient.apps().statefulSets().inNamespace(namespace).create(statefulset);

       <span style="color:#080;font-weight:bold">return</span> UpdateControl.noUpdate();

   } <span style="color:#080;font-weight:bold">else</span> <span style="color:#080;font-weight:bold">if</span> (statefulset.getStatus().getReplicas() &lt; spec.getReplicas()) {

       log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Scale statefulset up: </span><span style="color:#710">&quot;</span></span> + spec.getName());

       kubernetesClient.apps()
               .statefulSets()
               .inNamespace(namespace).withName(spec.getName()).scale(statefulset.getStatus().getReplicas() + <span style="color:#00D">1</span>, <span style="color:#069">true</span>);

       <span style="color:#080;font-weight:bold">return</span> UpdateControl.noUpdate();

   } <span style="color:#080;font-weight:bold">else</span> <span style="color:#080;font-weight:bold">if</span> (statefulset.getStatus().getReplicas() &gt; spec.getReplicas()) {

       log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Scale statefulset down: </span><span style="color:#710">&quot;</span></span> + spec.getName());

       kubernetesClient.apps()
               .statefulSets()
               .inNamespace(namespace).withName(spec.getName()).scale(spec.getReplicas(), <span style="color:#069">true</span>);

       <span style="color:#080;font-weight:bold">return</span> UpdateControl.noUpdate();
   }

   <span style="color:#080;font-weight:bold">return</span> UpdateControl.noUpdate();</code></pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>Containers are running following command to check if the data is present in the container, and outputs an error to a log if data is not present.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"while sleep 5; do cat /tmp/data.txt; done"</pre>
</div>
</div>
<div class="paragraph">
<p>PodWatcher watches pod creatiion and modification</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">PodWatcher</span> {

<span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> KubernetesClient kubernetesClient;

<span style="color:#339;font-weight:bold">void</span> onStartup(<span style="color:#007">@Observes</span> StartupEvent startupEvent) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span> {

   <span style="color:#088;font-weight:bold">public</span> PodWatcher(KubernetesClient kubernetesClient) {
      <span style="color:#950">this</span>.kubernetesClient = kubernetesClient;
   }


   kubernetesClient.pods().watch(<span style="color:#080;font-weight:bold">new</span> Watcher&lt;Pod&gt;() {

   <span style="color:#007">@Override</span>
   <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> eventReceived(<span style="color:#0a8;font-weight:bold">Action</span> action, Pod pod) {...}

   <span style="color:#007">@Override</span>
   <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> onClose(WatcherException e) {...}
});

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Start an operator</p>
</div>
<div class="listingblock">
<div class="title">QuarkusApplication.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@QuarkusMain</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> <span style="color:#088;font-weight:bold">implements</span> QuarkusApplication {

   <span style="color:#007">@Inject</span>
   Operator operator;

   <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span>... args) {
       Quarkus.run(Main.class, args);
   }

   <span style="color:#007">@Override</span>
   <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">int</span> run(<span style="color:#0a8;font-weight:bold">String</span>... args) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span> {
       operator.start();
       Quarkus.waitForExit();
       <span style="color:#080;font-weight:bold">return</span> <span style="color:#00D">0</span>;
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When pod is created operator fetches logs and
checks if the data from custom object is present in the pod, in case if it is not present operator outputs data to a file in the pod.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Get pod logs </span><span style="color:#710">&quot;</span></span> + pod.getMetadata().getName());

<span style="color:#0a8;font-weight:bold">String</span> logs = kubernetesClient.pods()
        .inNamespace(pod.getMetadata().getNamespace())
        .withName(pod.getMetadata().getName())
        .getLog();

log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Check if data is available in pod </span><span style="color:#710">&quot;</span></span> + pod.getMetadata().getName());

<span style="color:#080;font-weight:bold">if</span> (!logs.contains(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Example of injected data</span><span style="color:#710">&quot;</span></span>)) {
    log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Inject data into pod </span><span style="color:#710">&quot;</span></span> + pod.getMetadata().getName());
    newExecWatch(kubernetesClient, pod.getMetadata().getNamespace(), pod.getMetadata().getName(), spec.getData());
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>echo "Example of injected data" &gt; /tmp/data.txt</pre>
</div>
</div>
<div class="paragraph">
<p>After executing a command, the operator checks the log of the current pod  again. If the application has consumed the data, it add one pod to the replica set cluster and repeats this operation until all desired pods are present and contain the data.</p>
</div>
<details>
<summary class="title">PodWatcher.java</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#339;font-weight:bold">void</span> onStartup(<span style="color:#007">@Observes</span> StartupEvent startupEvent) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span> {

   <span style="color:#0a8;font-weight:bold">List</span>&lt;Pod&gt; pods = kubernetesClient.pods().inNamespace(namespace).list().getItems();

   kubernetesClient.pods().watch(<span style="color:#080;font-weight:bold">new</span> Watcher&lt;Pod&gt;() {

       <span style="color:#007">@Override</span>
       <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> eventReceived(<span style="color:#0a8;font-weight:bold">Action</span> action, Pod pod) {

           log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Received </span><span style="color:#710">&quot;</span></span> + action + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">, pod name </span><span style="color:#710">&quot;</span></span> + pod.getMetadata().getName());

           CustomResourceDefinitionContext helloWorldCustomResource = CustomResourceDefinitionContext.fromCustomResourceType(HelloWorld.class);
           <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">Object</span>&gt; cr = kubernetesClient.customResource(helloWorldCustomResource).get(namespace, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">hello-world-example</span><span style="color:#710">&quot;</span></span>);
           HelloWorldSpec spec = mapper.convertValue(cr.get(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">spec</span><span style="color:#710">&quot;</span></span>), HelloWorldSpec.class);

           <span style="color:#080;font-weight:bold">if</span> (action == <span style="color:#0a8;font-weight:bold">Action</span>.ADDED) {

               StatefulSet statefulset = kubernetesClient.apps().statefulSets().withName(spec.getName()).get();

               <span style="color:#080;font-weight:bold">try</span> {
                   <span style="color:#0a8;font-weight:bold">Thread</span>.sleep(<span style="color:#00D">10</span> * <span style="color:#00D">1000L</span>);
               } <span style="color:#080;font-weight:bold">catch</span> (<span style="color:#C00;font-weight:bold">InterruptedException</span> e) {
                   e.printStackTrace();
               }

               log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Get pod logs </span><span style="color:#710">&quot;</span></span> + pod.getMetadata().getName());

               <span style="color:#0a8;font-weight:bold">String</span> logs = kubernetesClient.pods()
                       .inNamespace(pod.getMetadata().getNamespace())
                       .withName(pod.getMetadata().getName())
                       .getLog();

               log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Check if data is available in pod </span><span style="color:#710">&quot;</span></span> + pod.getMetadata().getName());

               <span style="color:#080;font-weight:bold">if</span> (!logs.contains(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Example of injected data</span><span style="color:#710">&quot;</span></span>)) {
                   log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Inject data into pod </span><span style="color:#710">&quot;</span></span> + pod.getMetadata().getName());
                   newExecWatch(kubernetesClient, pod.getMetadata().getNamespace(), pod.getMetadata().getName(), spec.getData());
               }

               <span style="color:#080;font-weight:bold">try</span> {
                   <span style="color:#0a8;font-weight:bold">Thread</span>.sleep(<span style="color:#00D">10</span> * <span style="color:#00D">1000L</span>);
               } <span style="color:#080;font-weight:bold">catch</span> (<span style="color:#C00;font-weight:bold">InterruptedException</span> e) {
                   e.printStackTrace();
               }

               logs = kubernetesClient.pods()
                       .inNamespace(pod.getMetadata().getNamespace())
                       .withName(pod.getMetadata().getName())
                       .getLog();

               <span style="color:#080;font-weight:bold">if</span> (logs.contains(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Example of injected data</span><span style="color:#710">&quot;</span></span>)) {

                   log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Data is available in pod </span><span style="color:#710">&quot;</span></span> + pod.getMetadata().getName());

                   <span style="color:#080;font-weight:bold">if</span> (spec.getReplicas() &gt; statefulset.getStatus().getReplicas()) {

                       log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Scale statefulset size, current size </span><span style="color:#710">&quot;</span></span> + spec.getName());

                       <span style="color:#080;font-weight:bold">try</span> {
                           scaleStatefulSet(pod.getMetadata().getNamespace(), spec.getName(), statefulset.getStatus().getReplicas());
                       } <span style="color:#080;font-weight:bold">catch</span> (<span style="color:#C00;font-weight:bold">Exception</span> ex) {
                           log.error(ex.getMessage());
                       }


                   }
                   {
                       log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Statefulset size: </span><span style="color:#710">&quot;</span></span> + statefulset.getStatus().getReplicas() + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">, desired: </span><span style="color:#710">&quot;</span></span> + statefulset.getStatus().getReplicas());
                   }


               }

           }

       }

       <span style="color:#007">@Override</span>
       <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> onClose(WatcherException e) {

       }
   });


}


<span style="color:#088;font-weight:bold">private</span> ExecWatch newExecWatch(KubernetesClient client, <span style="color:#0a8;font-weight:bold">String</span> namespace, <span style="color:#0a8;font-weight:bold">String</span> podName, <span style="color:#0a8;font-weight:bold">String</span> data) {
   <span style="color:#080;font-weight:bold">return</span> client.pods().inNamespace(namespace).withName(podName)
           .readingInput(<span style="color:#0a8;font-weight:bold">System</span>.in)
           .writingOutput(<span style="color:#0a8;font-weight:bold">System</span>.out)
           .writingError(<span style="color:#0a8;font-weight:bold">System</span>.err)
           .withTTY()
           .usingListener(<span style="color:#080;font-weight:bold">new</span> SimpleListener())
           .exec(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sh</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">-c</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">echo </span><span style="color:#b0b">\&quot;</span><span style="color:#710">&quot;</span></span> + data + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#b0b">\&quot;</span><span style="color:#D20"> &gt; /tmp/data.txt</span><span style="color:#710">&quot;</span></span>);
}

<span style="color:#339;font-weight:bold">void</span> scaleStatefulSet(<span style="color:#0a8;font-weight:bold">String</span> namespace, <span style="color:#0a8;font-weight:bold">String</span> name, <span style="color:#339;font-weight:bold">int</span> replicaSize) {

   log.info(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Scale statefulset </span><span style="color:#710">&quot;</span></span> + name);
   kubernetesClient.apps().statefulSets().inNamespace(namespace).withName(name).scale(replicaSize + <span style="color:#00D">1</span>, <span style="color:#069">true</span>);

}</code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect4">
<h5 id="_how_to_deploy_an_operator">How to deploy an operator</h5>
<div class="paragraph">
<p>The files for building docker images are generated during project creation by <a href="https://code.quarkus.io">quarkus.io</a> and Kubernetes resources for operator deployment are generated by operator SDK.</p>
</div>
<div class="paragraph">
<p>Build docker</p>
</div>
<div class="listingblock">
<div class="content">
<pre>docker build -f \
src/main/docker/Dockerfile.jvm \
-t user/k8-operator-quarkus-hello-world:1.0.0-SNAPSHOT .</pre>
</div>
</div>
<div class="paragraph">
<p>Deploy an operator in a cluster using auto-generated kubernetes resources such as <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">RBAC</a>, <a href="https://kubernetes.io/docs/concepts/services-networking/service/">Service</a>, <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/">ServiceAccount</a>, <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>kubectl apply -f target/kubernetes/kubernetes.yml</pre>
</div>
</div>
<details>
<summary class="title">kubernetes.yml</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#f8f;background:#505"><span style="color:#f4f">---</span></span>
<span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">ServiceAccount</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">annotations</span>:
    <span style="color:#606">app.quarkus.io/build-timestamp</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">2021-04-18 - 14:25:30 +0000</span></span>
  <span style="color:#606">labels</span>:
    <span style="color:#606">app.kubernetes.io/version</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0-SNAPSHOT</span></span>
    <span style="color:#606">app.kubernetes.io/name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span>
<span style="color:#f8f;background:#505"><span style="color:#f4f">---</span></span>
<span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Service</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">annotations</span>:
    <span style="color:#606">app.quarkus.io/build-timestamp</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">2021-04-18 - 14:25:30 +0000</span></span>
  <span style="color:#606">labels</span>:
    <span style="color:#606">app.kubernetes.io/name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span>
    <span style="color:#606">app.kubernetes.io/version</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0-SNAPSHOT</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">ports</span>:
  - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: http</span></span>
    <span style="color:#606">port</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">8877</span></span>
    <span style="color:#606">targetPort</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">8877</span></span>
  <span style="color:#606">selector</span>:
    <span style="color:#606">app.kubernetes.io/name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span>
    <span style="color:#606">app.kubernetes.io/version</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0-SNAPSHOT</span></span>
  <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">ClusterIP</span></span>
<span style="color:#f8f;background:#505"><span style="color:#f4f">---</span></span>
<span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">rbac.authorization.k8s.io/v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">RoleBinding</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world-view</span></span>
<span style="color:#606">roleRef</span>:
  <span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">ClusterRole</span></span>
  <span style="color:#606">apiGroup</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">rbac.authorization.k8s.io</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">view</span></span>
<span style="color:#606">subjects</span>:
- <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">kind: ServiceAccount</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span>
<span style="color:#f8f;background:#505"><span style="color:#f4f">---</span></span>
<span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">apps/v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Deployment</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">annotations</span>:
    <span style="color:#606">app.quarkus.io/build-timestamp</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">2021-04-18 - 14:25:30 +0000</span></span>
  <span style="color:#606">labels</span>:
    <span style="color:#606">app.kubernetes.io/version</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0-SNAPSHOT</span></span>
    <span style="color:#606">app.kubernetes.io/name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">replicas</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
  <span style="color:#606">selector</span>:
    <span style="color:#606">matchLabels</span>:
      <span style="color:#606">app.kubernetes.io/version</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0-SNAPSHOT</span></span>
      <span style="color:#606">app.kubernetes.io/name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span>
  <span style="color:#606">template</span>:
    <span style="color:#606">metadata</span>:
      <span style="color:#606">annotations</span>:
        <span style="color:#606">app.quarkus.io/build-timestamp</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">2021-04-18 - 14:25:30 +0000</span></span>
      <span style="color:#606">labels</span>:
        <span style="color:#606">app.kubernetes.io/version</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1.0.0-SNAPSHOT</span></span>
        <span style="color:#606">app.kubernetes.io/name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span>
    <span style="color:#606">spec</span>:
      <span style="color:#606">containers</span>:
      - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">env:</span></span>
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: KUBERNETES_NAMESPACE</span></span>
          <span style="color:#606">valueFrom</span>:
            <span style="color:#606">fieldRef</span>:
              <span style="color:#606">fieldPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">metadata.namespace</span></span>
        <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">user/k8-operator-quarkus-hello-world:1.0.0-SNAPSHOT</span></span>
        <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Always</span></span>
        <span style="color:#606">livenessProbe</span>:
          <span style="color:#606">failureThreshold</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">3</span></span>
          <span style="color:#606">httpGet</span>:
            <span style="color:#606">path</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/q/health/live</span></span>
            <span style="color:#606">port</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">8877</span></span>
            <span style="color:#606">scheme</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">HTTP</span></span>
          <span style="color:#606">initialDelaySeconds</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">0</span></span>
          <span style="color:#606">periodSeconds</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">30</span></span>
          <span style="color:#606">successThreshold</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
          <span style="color:#606">timeoutSeconds</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">10</span></span>
        <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span>
        <span style="color:#606">ports</span>:
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">containerPort: 8877</span></span>
          <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">http</span></span>
          <span style="color:#606">protocol</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">TCP</span></span>
        <span style="color:#606">readinessProbe</span>:
          <span style="color:#606">failureThreshold</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">3</span></span>
          <span style="color:#606">httpGet</span>:
            <span style="color:#606">path</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/q/health/ready</span></span>
            <span style="color:#606">port</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">8877</span></span>
            <span style="color:#606">scheme</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">HTTP</span></span>
          <span style="color:#606">initialDelaySeconds</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">0</span></span>
          <span style="color:#606">periodSeconds</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">30</span></span>
          <span style="color:#606">successThreshold</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
          <span style="color:#606">timeoutSeconds</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">10</span></span>
      <span style="color:#606">serviceAccount</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">k8-operator-quarkus-hello-world</span></span></code></pre>
</div>
</div>
</div>
</details>
</div>
</div>
<div class="sect1">
<h2 id="_closing_thoughts">Closing thoughts</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>this just an example</p>
</li>
<li>
<p>security</p>
</li>
<li>
<p>the possibilites</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://github.com/web1991t/k8-operator-quarkus-hello-world">Source code</a></p>
</div>
<div class="paragraph">
<p>Helpful links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/quarkiverse/quarkus-operator-sdk">quarkus-operator-sdk</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/kubernetes-client">kubernetes-client</a></p>
</li>
<li>
<p><a href="https://github.com/java-operator-sdk/">java-operator-sdk</a></p>
</li>
<li>
<p><a href="https://kubernetes.io/docs/concepts/extend-kubernetes/operator/">extend-kubernetes/operator</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-04-19 08:48:15 +0200
</div>
</div>
</body>
</html>